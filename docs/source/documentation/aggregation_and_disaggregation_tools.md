# Aggregation and disaggregation tools 
These tools summarise the land cover, soil, ecosystem services output, and tradeoffs output metrics based on user-defined aggregation units. The tool **Create data aggregation grid** can be used to create a shapefile of aggregation units in the shape of regular squares that cover the study area with user-defined thresholds and size. Alternatively, the user can supply their own shapefile of aggregation units such as sub-watersheds or using administrative bound- aries.

The aggregate metrics are reported in:

- Inverse Simpson diversity index 

- Shannon diversity index 

- Classifications per aggregation units 

- Mean patch size

***The documentation for these tools is in-progress as the tools are being revised to run with the latest version of LUCI.***

## Aggregate data

### Summary

This tool takes any feature class data and reports aggregate metrics according to the metrics specified above.

### Input

- **Output folder:** Specify the path and folder where the output of this tool will be stored. 

- **Data to aggregate:** Specify the path and filename of the feature class with the data to aggregate. 

- **Classification column:** Specify the column within the target feature class to be used as the basis for the aggregation analysis. 

- **Aggregation units:** Specify the path and filename of the feature class containing the aggregation units. 

- **Only consider aggregation units which fully lie within the study area:** If ticked, the tool will only
calculate the aggregation metrics for units that lie fully within the study area.

### Output

The outputs are grid squares reporting the aggregation in the above metrics.

## Aggregate LUCI input data

### Summary

This tool takes the folder generated by the **Generate Baseline** tool and calculates the above metrics for the land cover and soil data of the study area.

### Input

- **Output folder:** Specify the path to the folder where the ouputs from this tool will be saved. 

- **LUCI Baseline folder:** Specify the path and folder to the outputs from the **Generate Baseline** tool. 

- **Aggregation units:** Specify the path and filename of the feature class containing the aggregation units. 

- **Only consider aggregation units which fully lie within the study area:** If ticked, the tool will only calculate the aggregation metrics for units that lie fully within the study area. 

- **Calculate landcover statistics?** Tick this box to calculate statistics for the land cover data. 

- **Calculate soil statistics?** Tick this box to calculate statistics for the soil data. 

- **Soil hierarchical level for analysis (NATMAP only):** If the soil data is NATMAP, specify the soil hierarchical level for the aggregation analysis.

### Output

The outputs are grid squares reporting the aggregation in the above metrics.

## Create aggregation grid

### Summary

This tool creates a grid of squares over the input study area with a user-defined size and coverage.

### Input

- **Boundary feature class:** Specify the path and filename to the feature class of the study area. 

- **Output grid feature class:** Specify the path and filename of the output grid file. 

- **Cell size in projection units:** Specify in the size of the grid squares in map projection units. If the desired cell size is a proportion of the study area's total rectangular extent (e.g. 10% of the extent), set this parameter to 0 and modify the *Proportion of total rectangular extent area for each cell* parameter below. 

- **Proportion of total rectangular extent area for each cell:** Specify the desired cell size as a proportion (between 0 to 1) of the total rectangular extent. For example, if the desired cell size is 10% of the extent, then this parameter should be 0.1. 

- **Grid coverage:** Specify the extent of the output grid: 

    - *Rectangular, covering full extent of boundary feature class:* The output grid will be rectangular in shape and cover the full height and width of the boundary. 

    - *Grid covers area bounded by boundary feature class only:* The output grid will follow the boundary of the feature class. 

- **Percentage area for grid cells on boundary:** If the second option is chosen above, specify the percentage area of the grid cells on the boundary that will be included in the aggregation grid. 

- **Buffer radius (in projection units):** Specify the size of the optional buffer in map projection units. 

- **Align to grid:** If True, sets the grid to integer extent values, and aligns to appropriate coordinates, rounding min xy values down, and max xy up, depending on the distance between the shortest polygon extent side. 

- **Significant figures:** Number of significant figures to align the coordinates to. This refers to the difference between the shortest length, so for coordinates of 123411 and 123511, where the difference is 100, and a sig_figs value of 2, the output would be 123410 and 123510. *Default is 3.*

### Output

This tool produces a grid of regular squares according to the size, coverage, and thresholds specified by the user.

## Report aggregate habitat metrics

### Summary

This tool reports habitat diversity metrics for aggregated regions. It includes Shannon's index, Simpson's index, mean patch size and total number of habitats.

### Input

- **Output folder:** Specify the path and folder where output from this tool should be stored. 

- **Aggregation Units:** Specify the polygon shapefile that outlines your aggregate units. Outputs will be reported at each individual polygon within this class. The mask could be a collation of political regions, a collection of catchments or subcatchments, a grid (e.g. for reporting by 1 km{math}`^2`), etc. 

- **LUCI Baseline folder:** Specify the path and folder where files are stored from running the **Generate Baseline** tool.

### Output

This tool outputs summary statistics to a copy of the spatial data layer used for aggregation. The statistics calculated are: number of habitats, Shannon index and Simpsons index. The results are dependent on accuracy of the spatial input data layer for landcover, as well as the level of disaggregation by type applied (broad habitat subclass or aggregated). Both Shannon and Simpson indexes are indicative of probability of occurrence, according to the equation:

```{math}
Shannon = − ∑(Probability\ of\ occurrence) ∗ log(Probability\ of\ occurrence)
```

```{math}
Simpsons = ∑(Probability\ of\ occurrence^2)
```

## Report aggregate input statistics

### Summary

This tool reports aggregated statistics on land cover, soil, and/or topographical/climate information.

### Input

- **Output folder:** Specify the path and folder where output from this tool should be stored. 

- **Aggregation Units:** Specify the polygon shapefile that outlines your aggregate units. Outputs will be reported at each individual polygon within this class. The mask could be a collation of political regions, a collection of catchments or subcatchments, a grid (e.g. for reporting by 1 km{math}`^2`), etc. 

- **LUCI Baseline folder:** Specify the path and folder where files are stored from running the **Generate Baseline** tool. 

- **Calculate landcover stats? and Landcover reporting option:** Tick the box to calculate land cover statistics. The available land cover reporting options are: 

    - *1:* calculates all land cover present 

    - *2:* divides the land cover into broad classes 

    - *3:* divides land cover into "water", improved, other grass, bogs, conifers, etc. 

- **Calculate soil statistics? and Soil reporting option:** Tick the box to calculate soil statistics. The available soil reporting options are: 

    - *1:* full soils reporting 

    - *2:* simplified soils reporting 

    - *3:* very simplified soils reporting 

- **Calculate topographical and climate statistics?:** Tick this box to calculate topographical/climate statistics.

### Output

- ***In-progress***

## Report aggregate single services metrics

### Summary

This tool reports aggregated statistics from a range of LUCI single service outputs.

### Input

- **Output folder:** Specify the path and folder where output from this tool should be stored. 

- **Aggregation Units:** Specify the polygon shapefile that outlines your aggregate units. Outputs will be reported at each individual polygon within this class. The mask could be a collation of political regions, a collection of catchments or subcatchments, a grid (e.g. for reporting by 1 km{math}`^2`), etc. 

- **LUCI Baseline folder:** Specify the path and folder where files are stored from running the **Generate Baseline** tool. 

- **LUCI Single Services Folder:** Specify the path to the folder containt the LUCI ecosystem service output. 

- **Report service?:** Tick the succeeding tickboxes to report statistics from different services.

### Output

- ***In-progress***

## Report aggregate soil metrics

### Summary

This tool reports aggregated soil metrics for NATMAP soils.

### Input

- **Output folder:** Specify the path and folder where output from this tool should be stored. 

- **Aggregation Units:** Specify the polygon shapefile that outlines your aggregate units. Outputs will be reported at each individual polygon within this class. The mask could be a collation of political regions, a collection of catchments or subcatchments, a grid (e.g. for reporting by 1 km{math}`^2`), etc. 

- **LUCI Baseline folder:** Specify the path and folder where files are stored from running the **Generate Baseline** tool. 

- **Soil hierarchical level for analysis:** Specify the hierarchical level within NATMAP for analysis: 

    - *1:* top level 

    - *2:* SOIL_LEVU1 

    - *3:* SOIL_LEVU2 

    - *4:* SOIL_LEVU3 

### Output

- ***In-progress***

## Report aggregate tradeoff metrics

### Summary

This tool reports aggregated statistics from LUCI tradeoffs.

### Input

- **Output folder:** Specify the path and folder where output from this tool should be stored. 

- **Aggregation Units:** Specify the polygon shapefile that outlines your aggregate units. Outputs will be reported at each individual polygon within this class. The mask could be a collation of political regions, a collection of catchments or subcatchments, a grid (e.g. for reporting by 1 km{math}`^2`), etc. 

- **LUCI Baseline folder:** Specify the path and folder where files are stored from running the **Generate Baseline** tool. 

- **LUCI Tradeoff Folder:** Specify the path to the folder generated by the **Tradeoff maps** tool. 

- **Report service combinations?:** Tick the succeeding tickboxes to report statistics from tradeoffs with that service.

### Output

- ***In-progress***
